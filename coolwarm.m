function map = coolwarm(varargin)
%% Examples
%   coolwarm(5)
%   coolwarm(17, 'clims', [-1 1])
%   coolwarm(16, 'clims', [-1 2])
%   coolwarm(16, 'clims', [-2 1])
%   coolwarm(13, 'clims', [-1 2], 'mode', 'trimmed')
%   coolwarm(13, 'clims', [-1 2], 'mode', 'complete')
%% See also
%   disp(sprintf('"%s"\n', readlines('coolwarm.m')))

%% Prelims
ip = inputParser;
ip.addOptional('n', size(get(groot,'DefaultFigureColormap'),1));
ip.addParameter('center', 0);
ip.addParameter('clims', [-1 1]);
ip.addParameter('mode', 'trimmed', @(x) ismember(x, {'trimmed', 'complete'}));
ip.addParameter('Parent', get(groot,'CurrentFigure'));

ip.parse(varargin{:});
n = ip.Results.n; 
clims = ip.Results.clims;
mode = ip.Results.mode; autoscaleColors = strcmpi(mode, 'trimmed');
Parent = ip.Results.Parent();


%% Sort out inputs (n, clim, colors)
ipiud = @(fieldname) any(strcmp( ip.UsingDefaults , fieldname ));
if ipiud('n')     && ~isempty(Parent) && isprop(Parent, 'Colormap'); n = height(get(Parent, 'Colormap')); end
if ipiud('clims') && ~isempty(Parent) && isprop(Parent, 'CLim');     clims = get(Parent, 'CLim');         end
clims = clims - ip.Results.center;

values = [...
0.229805700000000	0.298717966000000	0.753683153000000
0.234377079450980	0.305541730329412	0.759679527588235
0.238948458901961	0.312365494658824	0.765675902176471
0.243519838352941	0.319189258988235	0.771672276764706
0.248091217803922	0.326013023317647	0.777668651352941
0.252662597254902	0.332836787647059	0.783665025941176
0.257233976705882	0.339660551976471	0.789661400529412
0.261805356156863	0.346484316305882	0.795657775117647
0.266381468352941	0.353304408423529	0.801637319498039
0.271104295647059	0.360010661976471	0.807095127435294
0.275827122941176	0.366716915529412	0.812552935372549
0.280549950235294	0.373423169082353	0.818010743309804
0.285272777529412	0.380129422635294	0.823468551247059
0.289995604823529	0.386835676188235	0.828926359184314
0.294718432117647	0.393541929741176	0.834384167121569
0.299441259411765	0.400248183294118	0.839841975058824
0.304174287003922	0.406944882839216	0.845262726698039
0.309060319066667	0.413498272266667	0.850127633866667
0.313946351129412	0.420051661694118	0.854992541035294
0.318832383192157	0.426605051121569	0.859857448203922
0.323718415254902	0.433158440549020	0.864722355372549
0.328604447317647	0.439711829976471	0.869587262541177
0.333490479380392	0.446265219403922	0.874452169709804
0.338376511443137	0.452818608831373	0.879317076878431
0.343277523435294	0.459353634729412	0.884121921623529
0.348323341411765	0.465711146509804	0.888346162941177
0.353369159388235	0.472068658290196	0.892570404258824
0.358414977364706	0.478426170070588	0.896794645576471
0.363460795341177	0.484783681850980	0.901018886894118
0.368506613317647	0.491141193631373	0.905243128211765
0.373552431294118	0.497498705411765	0.909467369529412
0.378598249270588	0.503856217192157	0.913691610847059
0.383662065772549	0.510183417286275	0.917830673231373
0.388851871952941	0.516298435576471	0.921373483082353
0.394041678133333	0.522413453866667	0.924916292933333
0.399231484313725	0.528528472156863	0.928459102784314
0.404421290494118	0.534643490447059	0.932001912635294
0.409611096674510	0.540758508737255	0.935544722486275
0.414800902854902	0.546873527027451	0.939087532337255
0.419990709035294	0.552988545317647	0.942630342188235
0.425198970196078	0.559058179764706	0.946061457078431
0.430506888250980	0.564882741458824	0.948889419180392
0.435814806305882	0.570707303152941	0.951717381282353
0.441122724360784	0.576531864847059	0.954545343384314
0.446430642415686	0.582356426541177	0.957373305486275
0.451738560470588	0.588180988235294	0.960201267588235
0.457046478525490	0.594005549929412	0.963029229690196
0.462354396580392	0.599830111623530	0.965857191792157
0.467678094682353	0.605591231623529	0.968546281094118
0.473070172988235	0.611077437615686	0.970633588262745
0.478462251294118	0.616563643607843	0.972720895431372
0.483854329600000	0.622049849600000	0.974808202600000
0.489246407905882	0.627536055592157	0.976895509768627
0.494638486211765	0.633022261584314	0.978982816937255
0.500030564517647	0.638508467576471	0.981070124105882
0.505422642823529	0.643994673568628	0.983157431274510
0.510824324250980	0.649396614823529	0.985078776376471
0.516260302541177	0.654497610588235	0.986407399811765
0.521696280831373	0.659598606352941	0.987736023247059
0.527132259121569	0.664699602117647	0.989064646682353
0.532568237411765	0.669800597882353	0.990393270117647
0.538004215701961	0.674901593647059	0.991721893552941
0.543440193992157	0.680002589411765	0.993050516988235
0.548876172282353	0.685103585176471	0.994379140423529
0.554311869913725	0.690097011215686	0.995515548235294
0.559746725568627	0.694767728078431	0.996075309176471
0.565181581223530	0.699438444941177	0.996635070117647
0.570616436878431	0.704109161803922	0.997194831058823
0.576051292533333	0.708779878666667	0.997754592000000
0.581486148188235	0.713450595529412	0.998314352941176
0.586921003843137	0.718121312392157	0.998874113882353
0.592355859498039	0.722792029254902	0.999433874823529
0.597776775494118	0.727329724882353	0.999776731776471
0.603162067917647	0.731527477352941	0.999565278537255
0.608547360341177	0.735725229823529	0.999353825298039
0.613932652764706	0.739922982294118	0.999142372058824
0.619317945188235	0.744120734764706	0.998930918819608
0.624703237611765	0.748318487235294	0.998719465580392
0.630088530035294	0.752516239705882	0.998508012341177
0.635473822458824	0.756713992176471	0.998296559101961
0.640827782372549	0.760751506411765	0.997845774882353
0.646112810764706	0.764436496529412	0.996868462505882
0.651397839156863	0.768121486647059	0.995891150129412
0.656682867549020	0.771806476764706	0.994913837752941
0.661967895941176	0.775491466882353	0.993936525376471
0.667252924333333	0.779176457000000	0.992959213000000
0.672537952725490	0.782861447117647	0.991981900623529
0.677822981117647	0.786546437235294	0.991004588247059
0.683055681560784	0.790042626890196	0.989768428184314
0.688188483192157	0.793178379298039	0.988038104356863
0.693321284823529	0.796314131705882	0.986307780529412
0.698454086454902	0.799449884113725	0.984577456701961
0.703586888086275	0.802585636521569	0.982847132874510
0.708719689717647	0.805721388929412	0.981116809047059
0.713852491349020	0.808857141337255	0.979386485219608
0.718985292980392	0.811992893745098	0.977656161392157
0.724041371882353	0.814910392647059	0.975650970647059
0.728969579568628	0.817464135705882	0.973187668372549
0.733897787254902	0.820017878764706	0.970724366098039
0.738825994941176	0.822571621823530	0.968261063823529
0.743754202627451	0.825125364882353	0.965797761549020
0.748682410313726	0.827679107941177	0.963334459274510
0.753610618000000	0.830232851000000	0.960871157000000
0.758538825686274	0.832786594058824	0.958407854725490
0.763362780101961	0.835092221819608	0.955657676556863
0.768034364352941	0.837035219529412	0.952488218235294
0.772705948603922	0.838978217239216	0.949318759913726
0.777377532854902	0.840921214949020	0.946149301592157
0.782049117105882	0.842864212658824	0.942979843270588
0.786720701356863	0.844807210368628	0.939810384949020
0.791392285607843	0.846750208078432	0.936640926627451
0.796063869858824	0.848693205788235	0.933471468305882
0.800600847294118	0.850358321560784	0.930007560392157
0.804964758823530	0.851666160556863	0.926165074431373
0.809328670352941	0.852973999552941	0.922322588470588
0.813692581882353	0.854281838549020	0.918480102509804
0.818056493411765	0.855589677545098	0.914637616549020
0.822420404941177	0.856897516541177	0.910795130588235
0.826784316470588	0.858205355537255	0.906952644627451
0.831148228000000	0.859513194533333	0.903110158666667
0.835344711352941	0.860513997294118	0.898970409941177
0.839351442772549	0.861166825654902	0.894493763415686
0.843358174192157	0.861819654015686	0.890017116890196
0.847364905611765	0.862472482376471	0.885540470364706
0.851371637031373	0.863125310737255	0.881063823839216
0.855378368450980	0.863778139098039	0.876587177313726
0.859385099870588	0.864430967458824	0.872110530788235
0.863391831290196	0.865083795819608	0.867633884262745
0.867427635086275	0.864376599772549	0.862602462019608
0.871492511258824	0.862309379317647	0.857016264058824
0.875557387431373	0.860242158862745	0.851430066098039
0.879622263603922	0.858174938407843	0.845843868137255
0.883687139776471	0.856107717952941	0.840257670176471
0.887752015949020	0.854040497498039	0.834671472215686
0.891816892121569	0.851973277043137	0.829085274254902
0.895881768294118	0.849906056588235	0.823499076294118
0.899543206600000	0.847500236000000	0.817789074400000
0.902848670317647	0.844795650588235	0.811969833741177
0.906154134035294	0.842091065176471	0.806150593082353
0.909459597752941	0.839386479764706	0.800331352423530
0.912765061470588	0.836681894352941	0.794512111764706
0.916070525188235	0.833977308941177	0.788692871105882
0.919375988905882	0.831272723529412	0.782873630447059
0.922681452623529	0.828568138117647	0.777054389788235
0.925563423000000	0.825517298070588	0.771136307811765
0.928116009666667	0.822197148862745	0.765141349254902
0.930668596333333	0.818876999654902	0.759146390698039
0.933221183000000	0.815556850447059	0.753151432141177
0.935773769666667	0.812236701239216	0.747156473584314
0.938326356333333	0.808916552031373	0.741161515027451
0.940878943000000	0.805596402823529	0.735166556470588
0.943431529666667	0.802276253615686	0.729171597913725
0.945540298909804	0.798605740533333	0.723105417298039
0.947345403600000	0.794695504800000	0.716990505800000
0.949150508290196	0.790785269066667	0.710875594301961
0.950955612980392	0.786875033333333	0.704760682803922
0.952760717670588	0.782964797600000	0.698645771305882
0.954565822360784	0.779054561866667	0.692530859807843
0.956370927050981	0.775144326133333	0.686415948309804
0.958176031741177	0.771234090400000	0.680301036811765
0.959517658470588	0.766972854509804	0.674144715039216
0.960581198423529	0.762501018525490	0.667963547101961
0.961644738376471	0.758029182541177	0.661782379164706
0.962708278329412	0.753557346556863	0.655601211227451
0.963771818282353	0.749085510572549	0.649420043290196
0.964835358235294	0.744613674588235	0.643238875352941
0.965898898188235	0.740141838603922	0.637057707415686
0.966962438141176	0.735670002619608	0.630876539478431
0.967544297635294	0.730849716188235	0.624685478235294
0.967873848317647	0.725846908094118	0.618489234784314
0.968203399000000	0.720844100000000	0.612292991333333
0.968532949682353	0.715841291905882	0.606096747882353
0.968862500364706	0.710838483811765	0.599900504431372
0.969192051047059	0.705835675717647	0.593704260980392
0.969521601729412	0.700832867623529	0.587508017529412
0.969851152411765	0.695830059529412	0.581311774078431
0.969682979666667	0.690483930737255	0.575138361364706
0.969288569000000	0.684981747082353	0.568975326258824
0.968894158333333	0.679479563427451	0.562812291152941
0.968499747666667	0.673977379772549	0.556649256047059
0.968105337000000	0.668475196117647	0.550486220941176
0.967710926333333	0.662973012462745	0.544323185835294
0.967316515666667	0.657470828807843	0.538160150729412
0.966922105000000	0.651968645152941	0.531997115623530
0.966016719839216	0.646129741588235	0.525890348258824
0.964911388137255	0.640159078058823	0.519805598705882
0.963806056435294	0.634188414529412	0.513720849152941
0.962700724733333	0.628217751000000	0.507636099600000
0.961595393031373	0.622247087470588	0.501551350047059
0.960490061329412	0.616276423941176	0.495466600494118
0.959384729627451	0.610305760411765	0.489381850941177
0.958279397925490	0.604335096882353	0.483297101388235
0.956653210976471	0.598033822717647	0.477302292352941
0.954853405611765	0.591622345007843	0.471337463490196
0.953053600247059	0.585210867298039	0.465372634627451
0.951253794882353	0.578799389588235	0.459407805764706
0.949453989517647	0.572387911878431	0.453442976901961
0.947654184152941	0.565976434168627	0.447478148039216
0.945854378788235	0.559564956458824	0.441513319176471
0.944054573423530	0.553153478749020	0.435548490313726
0.941727929823529	0.546413477019608	0.429707070372549
0.939253771517647	0.539581488564706	0.423900204929412
0.936779613211765	0.532749500109804	0.418093339486275
0.934305454905883	0.525917511654902	0.412286474043137
0.931831296600000	0.519085523200000	0.406479608600000
0.929357138294118	0.512253534745098	0.400672743156863
0.926882979988235	0.505421546290196	0.394865877713725
0.924408821682353	0.498589557835294	0.389059012270588
0.921406221227451	0.491420417184314	0.383408435376471
0.918281672584314	0.484173472180392	0.377793925070588
0.915157123941177	0.476926527176471	0.372179414764706
0.912032575298039	0.469679582172549	0.366564904458824
0.908908026654902	0.462432637168627	0.360950394152941
0.905783478011765	0.455185692164706	0.355335883847059
0.902658929368627	0.447938747160784	0.349721373541177
0.899534380725490	0.440691802156863	0.344106863235294
0.895884594835294	0.433074556705882	0.338680634517647
0.892137542788235	0.425388737098039	0.333289272760784
0.888390490741177	0.417702917490196	0.327897911003922
0.884643438694118	0.410017097882353	0.322506549247059
0.880896386647059	0.402331278274510	0.317115187490196
0.877149334600000	0.394645458666667	0.311723825733333
0.873402282552941	0.386959639058824	0.306332463976471
0.869655230505882	0.379273819450980	0.300941102219608
0.865391332937255	0.371127672047059	0.295768956415686
0.861053600294118	0.362915763529412	0.290628127176471
0.856715867650980	0.354703855011765	0.285487297937255
0.852378135007843	0.346491946494118	0.280346468698039
0.848040402364706	0.338280037976471	0.275205639458824
0.843702669721569	0.330068129458823	0.270064810219608
0.839364937078431	0.321856220941176	0.264923980980392
0.835027204435294	0.313644312423529	0.259783151741177
0.830186521949020	0.304732763552941	0.254891428066667
0.825293810168628	0.295748838094118	0.250025473933333
0.820401098388235	0.286764912635294	0.245159519800000
0.815508386607843	0.277780987176471	0.240293565666667
0.810615674827451	0.268797061717647	0.235427611533333
0.805722963047059	0.259813136258823	0.230561657400000
0.800830251266667	0.250829210800000	0.225695703266667
0.795937539486275	0.241845285341176	0.220829749133333
0.790561531941177	0.231396999058824	0.216242038294118
0.785153304678432	0.220851088721569	0.211672877007843
0.779745077415686	0.210305178384314	0.207103715721569
0.774336850152941	0.199759268047059	0.202534554435294
0.768928622890196	0.189213357709804	0.197965393149020
0.763520395627451	0.178667447372549	0.193396231862745
0.758112168364706	0.168121537035294	0.188827070576471
0.752703941101961	0.157575626698039	0.184257909290196
0.746838012211765	0.140021019482353	0.179996096956863
0.740957318752941	0.122240325270588	0.175744199105882
0.735076625294118	0.104459631058824	0.171492301254902
0.729195931835294	0.0866789368470591	0.167240403403922
0.723315238376471	0.0688982426352939	0.162988505552941
0.717434544917647	0.0511175484235293	0.158736607701961
0.711553851458823	0.0333368542117646	0.154484709850980
0.705673158000000	0.0155561600000000	0.150232812000000
    ];
m = ceil(size(values,1)/2);


%% Calculations
if (clims(1) < 0) && (clims(2) > 0)

    r = abs(clims(1)) / clims(2); % Ratio of neg to pos
    neglen = round( n*r/(r+1) ) + (r<1); % favour the smaller half
    poslen = n - neglen + 1;

    % Just negative
    neglim = clims(1) - (autoscaleColors && r < 1)*sum(clims); % clims(1) or -clims(2)
    negmap = interp1( linspace( neglim,0,m), values( 1:m           , : ), linspace(clims(1),0,neglen) );

    % Just positive
    poslim = clims(2) - (autoscaleColors && r > 1)*sum(clims); % clims(2) or -clims(1)
    posmap = interp1( linspace( 0,poslim,m), values( (end-m+1):end , : ), linspace(0,clims(2),poslen) );

    % And put 'em together
    map = [negmap; posmap(2:end,:)];

else
    if clims(1) >= 0; map = values( (end-m+1):end , : ); % Just positive
    else; map = values(1:m,:); end % Just negative
    map = interp1(linspace(0, 1, m), map, linspace(0, 1, n));
end

map = min(max(map, 0), 1);


end
